
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.2">
    
    
      
        <title>Introduction - LiveHD and Pyrope</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7CFira+Code&display=fallback">
        <style>:root{--md-text-font-family:"";--md-code-font-family:"Fira Code"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LiveHD and Pyrope" class="md-header__button md-logo" aria-label="LiveHD and Pyrope" data-md-component="logo">
      
  <img src="../assets/pyrope5.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LiveHD and Pyrope
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/masc-ucsc/livehd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LiveHD and Pyrope" class="md-nav__button md-logo" aria-label="LiveHD and Pyrope" data-md-component="logo">
      
  <img src="../assets/pyrope5.png" alt="logo">

    </a>
    LiveHD and Pyrope
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/masc-ucsc/livehd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        LiveHD and Pyrope
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Livehd
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Livehd" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Livehd
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/01-install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/01-usage/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/02-lgraph/" class="md-nav__link">
        LGraph
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/03-lnast/" class="md-nav__link">
        LNAST
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/03c-mmapstr/" class="md-nav__link">
        mmap_lib::str
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/04a-bazel/" class="md-nav__link">
        Bazel build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/04b-pass/" class="md-nav__link">
        Creating a Pass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/04c-github/" class="md-nav__link">
        GitHub Guide
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../livehd/04d-style/" class="md-nav__link">
        Coding Style
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Pyrope
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pyrope" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Pyrope
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Introduction
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trivial-gcd" class="md-nav__link">
    Trivial GCD
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="02-basics/" class="md-nav__link">
        Basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="03-bundle/" class="md-nav__link">
        Bundles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="04-variables/" class="md-nav__link">
        Variables and types
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="05-assert/" class="md-nav__link">
        Assertions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="06-functions/" class="md-nav__link">
        Functions and methods
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="06b-pipelining/" class="md-nav__link">
        Pipelining
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="07-typesystem/" class="md-nav__link">
        Type system
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="09-stdlib/" class="md-nav__link">
        Pyrope std lib
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trivial-gcd" class="md-nav__link">
    Trivial GCD
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="introduction">Introduction</h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document explains the future Pyrope, some features are still not
implemented. They are documented to guide the designers.</p>
</div>
<p>Pyrope is a modern hardware description language, with these focus points:</p>
<ul>
<li>Fast parallel and incremental elaboration. </li>
<li>Help hardware verification:<ul>
<li>Powerful synthesizable type system</li>
<li>Hot-Reload support, powerful assertions</li>
<li>Allows Pyrope 2 Verilog, edit Verilog, Verilog 2 Pyrope, edit Pyrope...</li>
<li>Static checks as long as they not produce false positives</li>
</ul>
</li>
<li>Modern and concise language<ul>
<li>Avoiding hardware specific artifacts</li>
<li>Synthesis and simulation must be equal and deterministic</li>
<li>Zero cost abstraction</li>
</ul>
</li>
</ul>
<h2 id="hello-world">Hello World</h2>
<p>Create a directory for the project:
<div class="highlight"><pre><span></span><code>$ mkdir hello
$ cd hello
$ mkdir src
</code></pre></div></p>
<p>Populate the Pyrope code</p>
<p><code>src/hello.prp</code>
<div class="highlight"><pre><span></span><code>test &quot;quite empty&quot; {
  puts &quot;hello world&quot;
}
</code></pre></div></p>
<p>Run
<div class="highlight"><pre><span></span><code>$prp test
</code></pre></div></p>
<p>All the pyrope files reside in <code>src</code> directory. The <code>prp</code> builder calls LiveHD to
elaborate the pyrope files and run all the tests.</p>
<h2 id="trivial-gcd">Trivial GCD</h2>
<p>Populate the Pyrope code</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Pyrope</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>// src/gcd.prp
if $load_values {
  #x = $value1
  #y = $value2
}else{
  #x = if #x &gt; #y { #x - #y } else { #y - #x }
  %z = #x
  %v = #y == 0
}

test &quot;16bits gcd&quot; {
  for i in 1..=100 {
    for j in 1..=100 {
      $value1      = i
      $value2      = j
      $load_values = true

      puts &quot;trying gcd({},{})&quot;, $value1, $value2

      step 1 // advance 1 clock

      $load_values = false // deactivate load

      waitfor %z == true

      puts &quot;result is {}&quot;, %v
      assert %v == __my_cpp_gcd(v1=$value1, v2=$value2)
    }
  }
}

// src/my_cpp_gcd.cpp
void my_gcd_cpp(const Lbundle &amp;inp, Lbundle &amp;out) {
  auto [x,ok1] = inp.get_const(&quot;v1&quot;);
  auto [y,ok2] = inp.get_const(&quot;v2&quot;);

  assert(ok1 &amp;&amp; ok2); // both must be defined

  while (y &gt; 0) {
    if (x &gt; y) {
      x -= y
    }
    else {
      y -= x
    }
  }

  out.add_const(x);
}
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">CHISEL</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nc">Chisel</span><span class="p">.</span><span class="n">_</span>
<span class="k">import</span> <span class="nn">firrtl_interpreter</span><span class="p">.</span><span class="nc">InterpretiveTester</span>
<span class="k">import</span> <span class="nn">org</span><span class="p">.</span><span class="nn">scalatest</span><span class="p">.{</span><span class="nc">Matchers</span><span class="p">,</span> <span class="nc">FlatSpec</span><span class="p">}</span>

<span class="k">object</span> <span class="nc">GCDCalculator</span> <span class="p">{</span>
  <span class="k">def</span> <span class="nf">computeGcd</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nc">Int</span><span class="p">):</span> <span class="p">(</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="n">x</span> <span class="o">=</span> <span class="n">a</span>
    <span class="kd">var</span> <span class="n">y</span> <span class="o">=</span> <span class="n">b</span>
    <span class="k">while</span><span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">x</span> <span class="o">-=</span> <span class="n">y</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="n">x</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">x</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">GCD</span> <span class="k">extends</span> <span class="nc">Module</span> <span class="p">{</span>
  <span class="kd">val</span> <span class="n">io</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Bundle</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="n">a</span>  <span class="o">=</span> <span class="nc">UInt</span><span class="p">(</span><span class="nc">INPUT</span><span class="p">,</span>  <span class="mi">16</span><span class="p">)</span>
    <span class="kd">val</span> <span class="n">b</span>  <span class="o">=</span> <span class="nc">UInt</span><span class="p">(</span><span class="nc">INPUT</span><span class="p">,</span>  <span class="mi">16</span><span class="p">)</span>
    <span class="kd">val</span> <span class="n">e</span>  <span class="o">=</span> <span class="nc">Bool</span><span class="p">(</span><span class="nc">INPUT</span><span class="p">)</span>
    <span class="kd">val</span> <span class="n">z</span>  <span class="o">=</span> <span class="nc">UInt</span><span class="p">(</span><span class="nc">OUTPUT</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="kd">val</span> <span class="n">v</span>  <span class="o">=</span> <span class="nc">Bool</span><span class="p">(</span><span class="nc">OUTPUT</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="kd">val</span> <span class="n">x</span>  <span class="o">=</span> <span class="nc">Reg</span><span class="p">(</span><span class="nc">UInt</span><span class="p">())</span>
  <span class="kd">val</span> <span class="n">y</span>  <span class="o">=</span> <span class="nc">Reg</span><span class="p">(</span><span class="nc">UInt</span><span class="p">())</span>
  <span class="n">when</span>   <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="p">}</span>
  <span class="n">unless</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">}</span>
  <span class="n">when</span> <span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">io</span><span class="p">.</span><span class="n">a</span><span class="p">;</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">io</span><span class="p">.</span><span class="n">b</span> <span class="p">}</span>
  <span class="n">io</span><span class="p">.</span><span class="n">z</span> <span class="o">:=</span> <span class="n">x</span>
  <span class="n">io</span><span class="p">.</span><span class="n">v</span> <span class="o">:=</span> <span class="n">y</span> <span class="o">===</span> <span class="nc">UInt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>


<span class="k">class</span> <span class="nc">InterpreterUsageSpec</span> <span class="k">extends</span> <span class="nc">FlatSpec</span> <span class="k">with</span> <span class="nc">Matchers</span> <span class="p">{</span>

  <span class="s">&quot;GCD&quot;</span> <span class="n">should</span> <span class="s">&quot;return correct values for a range of inputs&quot;</span> <span class="n">in</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="n">s</span> <span class="o">=</span> <span class="nc">Driver</span><span class="p">.</span><span class="n">emit</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nc">GCD</span><span class="p">)</span>

    <span class="kd">val</span> <span class="n">tester</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InterpretiveTester</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">{</span>
      <span class="n">i</span> <span class="o">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">100</span>
      <span class="n">j</span> <span class="o">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">100</span>
    <span class="p">}</span> <span class="p">{</span>
      <span class="n">tester</span><span class="p">.</span><span class="n">poke</span><span class="p">(</span><span class="s">&quot;io_a&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
      <span class="n">tester</span><span class="p">.</span><span class="n">poke</span><span class="p">(</span><span class="s">&quot;io_b&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
      <span class="n">tester</span><span class="p">.</span><span class="n">poke</span><span class="p">(</span><span class="s">&quot;io_e&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">tester</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>
      <span class="n">tester</span><span class="p">.</span><span class="n">poke</span><span class="p">(</span><span class="s">&quot;io_e&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

      <span class="k">while</span> <span class="p">(</span><span class="n">tester</span><span class="p">.</span><span class="n">peek</span><span class="p">(</span><span class="s">&quot;io_v&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="nc">BigInt</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">tester</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>
      <span class="p">}</span>
      <span class="n">tester</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;io_z&quot;</span><span class="p">,</span> <span class="nc">BigInt</span><span class="p">(</span><span class="nc">GCDCalculator</span><span class="p">.</span><span class="n">computeGcd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">).</span><span class="n">_1</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="n">tester</span><span class="p">.</span><span class="n">report</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<p>Run
<div class="highlight"><pre><span></span><code>$prp test gcd
</code></pre></div></p>
<p>The <code>gcd.prp</code> includes the top level module (<code>gcd</code>) and the unit test. To understand the differences
with alternative HDLs, the same GCD with CHISEL:</p>
<p>Some of the visible differences:</p>
<ul>
<li>Pyrope has global type inference. The gcd.prp file doe not specify any size. The size
is inferred from instantiation, in this case the test.</li>
<li>Pyrope has special variable markers: $ is for inputs, % for outputs, and # for registers.</li>
<li>CHISEL is a DSL. E.g: the <code>=</code> are SCALA, the <code>===</code> is generated HDL. The GCDCalculator is
a SCALA program, and the GCD is a generated CHISEL module.</li>
</ul>
<p>Some not so visible differences:</p>
<p>Pyrope is not a DSL. There are several DSL Hardware Description Languages (HDL)
like CHISEL, pyMTL, pyRTL, CÎ»aSH. In all the DSL cases, there is a host
language (SCALA, or Python, or Haskell) that must be executed. The result of
the execution is the hardware description which can be Verilog or some internal
IR like FIRRTL in CHISEL. The advantage of the DSL is that it can leverage the
existing language to have a nice hardware generator. The disadvantage is that
there are 2 languages at once, the DSL and the host language, and that it is
difficult to do incremental because the generated executable from host language
must be executed to generate the design.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../livehd/04d-style/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Coding Style" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Coding Style
            </div>
          </div>
        </a>
      
      
        
        <a href="02-basics/" class="md-footer__link md-footer__link--next" aria-label="Next: Basics" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Basics
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.instant", "navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.2b46852b.min.js"></script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>